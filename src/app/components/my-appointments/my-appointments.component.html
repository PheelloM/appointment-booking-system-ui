<div class="my-appointments-container">
  <div class="appointments-header">
    <h1>My Appointments</h1>
    <p>View and manage your scheduled appointments</p>
    <button class="btn btn-primary" (click)="bookNewAppointment()">
      <i class="fas fa-plus"></i> Book New Appointment
    </button>
  </div>

  <div class="appointments-content">
    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
      <div class="spinner"></div>
      <p>Loading your appointments...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-state">
      <i class="fas fa-exclamation-triangle"></i>
      <p>{{ error }}</p>
      <button class="btn btn-outline" (click)="loadMyAppointments()">
        <i class="fas fa-redo"></i> Try Again
      </button>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && !error && appointments.length === 0" class="empty-state">
      <i class="fas fa-calendar-times"></i>
      <h3>No Appointments Found</h3>
      <p>You haven't booked any appointments yet.</p>
      <button class="btn btn-primary" (click)="bookNewAppointment()">
        <i class="fas fa-plus"></i> Book Your First Appointment
      </button>
    </div>

    <!-- Appointments List -->
    <div *ngIf="!loading && appointments.length > 0" class="appointments-list">
      <div class="appointments-summary">
        <p>You have {{ appointments.length }} appointment(s)</p>
      </div>
      
      <div *ngFor="let appointment of appointments" class="appointment-card">
        <div class="appointment-header">
          <div class="appointment-info">
            <h3>{{ appointment.branchName }}</h3>
            <span class="appointment-ref">Ref: {{ appointment.bookingReference }}</span>
          </div>
          <div class="appointment-status">
            <span [class]="'status-badge ' + getStatusClass(appointment.status)">
              {{ appointment.status | titlecase }}
            </span>
          </div>
        </div>

        <div class="appointment-details">
          <div class="detail-item">
            <i class="fas fa-user"></i>
            <span>{{ appointment.customerName }}</span>
          </div>
          <div class="detail-item">
            <i class="fas fa-envelope"></i>
            <span>{{ appointment.customerEmail }}</span>
          </div>
          <div class="detail-item">
            <i class="fas fa-phone"></i>
            <span>{{ appointment.customerPhone || 'Not provided' }}</span>
          </div>
          <div class="detail-item">
            <i class="fas fa-calendar-day"></i>
            <span>{{ formatDate(appointment.appointmentDate) }}</span>
          </div>
          <div class="detail-item">
            <i class="fas fa-clock"></i>
            <span>{{ formatTime(appointment.startTime) }} - {{ formatTime(appointment.endTime) }}</span>
          </div>
          <div class="detail-item">
            <i class="fas fa-map-marker-alt"></i>
            <span>{{ appointment.branchAddress }}</span>
          </div>
        </div>

        <div class="appointment-actions">
          <button 
  *ngIf="canCancel(appointment)"
  class="btn btn-danger" 
  (click)="cancelAppointment(appointment.bookingReference)"
  [disabled]="isCanceling(appointment.bookingReference) || loading">
  <i class="fas fa-times"></i> 
  <span *ngIf="!isCanceling(appointment.bookingReference)">Cancel</span>
  <span *ngIf="isCanceling(appointment.bookingReference)">Cancelling...</span>
</button>
          
          <button 
            *ngIf="canReschedule(appointment)"
            class="btn btn-outline" 
            (click)="rescheduleAppointment(appointment)">
            <i class="fas fa-calendar-alt"></i> Reschedule
          </button>
          
          <button 
            class="btn btn-secondary"
            (click)="viewAppointmentDetails(appointment.bookingReference)">
            <i class="fas fa-eye"></i> View Details
          </button>
        </div>
      </div>
    </div>
  </div>
</div>